// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:dev.db"
}

model User {
  UID     String   @id @default(uuid())
  Name    String
  Email   String   @unique
  Phone   String?
  Type    UserType
  Patient Patient?
}

enum UserType {
  PARENT
  PATIENT
  ADMIN
  THERAPIST
}

model Parent {
  UID         String        @id @default(uuid())
  DOB         DateTime
  Gender      Gender
  Address     String
  Children    Patient[]
  ContactForm ContactForm[]
}

model Patient {
  UID            String           @id @default(uuid())
  DOB            DateTime
  Gender         Gender
  Address        String
  Identification String
  Sponsor        Sponsor?         @relation(fields: [SponsorID], references: [SID])
  SponsorID      String?
  Diagnosed      Boolean
  Appointments   Appointment[]
  MedicalRecords MedicalRecord?
  ProgressReport ProgressReport[]

  ParentID String?

  User        User         @relation(fields: [UID], references: [UID])
  Parent      Parent?      @relation(fields: [ParentID], references: [UID])
  ContactForm ContactForm?
}

enum Gender {
  MALE
  FEMALE
  OTHER
}

model Appointment {
  AID     String   @id @default(uuid())
  Type    String
  Time    DateTime
  Comment String

  PID       String
  Patient   Patient   @relation(fields: [PID], references: [UID])
  TID       String
  Therapist Therapist @relation(fields: [TID], references: [TID])
}

model MedicalRecord {
  PID     String  @id
  Data    String
  Patient Patient @relation(fields: [PID], references: [UID])
}

model Therapist {
  TID             String        @id @default(uuid())
  Specializations String
  Appointments    Appointment[]
}

// enum Specialization {
//   LEARNING
//   SOCIAL_HABILITATION
//   CONDUCTUAL
//   INTERVENTIONAL
//   LANGUAGE
//   OCCUPATIONAL
//   INDEPENDENT_LIVING
// }

model Sponsor {
  SID      String    @id @default(uuid())
  Name     String
  Contact  String
  Patients Patient[]
}

model ProgressReport {
  RID         String                   @id @default(uuid())
  PID         String
  DateCreated DateTime                 @default(now())
  Patient     Patient                  @relation(fields: [PID], references: [UID])
  Responses   ProgressReportResponse[]
}

model ProgressReportResponse {
  ID       String @id @default(uuid())
  RID      String
  Question String
  Answer   String

  Report ProgressReport @relation(fields: [RID], references: [RID])
}

model ContactForm {
  FID                 String   @id @default(uuid())
  Patient             Patient  @relation(fields: [patientUID], references: [UID])
  DOB                 DateTime
  Gender              Gender
  Parent              Parent?  @relation(fields: [parentUID], references: [UID])
  Identification      String
  Address             String
  Email               String   @unique
  Phone               String?
  Diagnosed           Boolean
  BeenHereBefore      Boolean
  WantsDiagnosticEval Boolean
  Comments            String?
  patientUID          String   @unique
  parentUID           String?
}
